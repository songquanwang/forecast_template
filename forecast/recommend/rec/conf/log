#############原始特征 +num_direct_distance
Training until validation scores don't improve for 500 rounds.
[50]	valid_0's multi_logloss: 1.03323	valid_0's weighted-f1-score: 0.652111
[100]	valid_0's multi_logloss: 0.937565	valid_0's weighted-f1-score: 0.656229
[150]	valid_0's multi_logloss: 0.914876	valid_0's weighted-f1-score: 0.657743
[200]	valid_0's multi_logloss: 0.908095	valid_0's weighted-f1-score: 0.658494
[250]	valid_0's multi_logloss: 0.905642	valid_0's weighted-f1-score: 0.658884
[300]	valid_0's multi_logloss: 0.904534	valid_0's weighted-f1-score: 0.658929
[350]	valid_0's multi_logloss: 0.904061	valid_0's weighted-f1-score: 0.659063
[400]	valid_0's multi_logloss: 0.903807	valid_0's weighted-f1-score: 0.659095
[450]	valid_0's multi_logloss: 0.903608	valid_0's weighted-f1-score: 0.659046
[500]	valid_0's multi_logloss: 0.903365	valid_0's weighted-f1-score: 0.658952
[550]	valid_0's multi_logloss: 0.903244	valid_0's weighted-f1-score: 0.659002
[600]	valid_0's multi_logloss: 0.903135	valid_0's weighted-f1-score: 0.659222
[650]	valid_0's multi_logloss: 0.903095	valid_0's weighted-f1-score: 0.659148
[700]	valid_0's multi_logloss: 0.903167	valid_0's weighted-f1-score: 0.659301
[750]	valid_0's multi_logloss: 0.903193	valid_0's weighted-f1-score: 0.659446
[800]	valid_0's multi_logloss: 0.90311	valid_0's weighted-f1-score: 0.659484
[850]	valid_0's multi_logloss: 0.903233	valid_0's weighted-f1-score: 0.659507
[900]	valid_0's multi_logloss: 0.903284	valid_0's weighted-f1-score: 0.659313


################################ p_cls
[50]	valid_0's multi_logloss: 1.03673	valid_0's weighted-f1-score: 0.650742
[100]	valid_0's multi_logloss: 0.941969	valid_0's weighted-f1-score: 0.654669
[150]	valid_0's multi_logloss: 0.919398	valid_0's weighted-f1-score: 0.65656
[200]	valid_0's multi_logloss: 0.912672	valid_0's weighted-f1-score: 0.656734
[250]	valid_0's multi_logloss: 0.910147	valid_0's weighted-f1-score: 0.657355
[300]	valid_0's multi_logloss: 0.90908	valid_0's weighted-f1-score: 0.657569
[350]	valid_0's multi_logloss: 0.908477	valid_0's weighted-f1-score: 0.657885
[400]	valid_0's multi_logloss: 0.908139	valid_0's weighted-f1-score: 0.658007
[450]	valid_0's multi_logloss: 0.907926	valid_0's weighted-f1-score: 0.658211
[500]	valid_0's multi_logloss: 0.907798	valid_0's weighted-f1-score: 0.658401
[550]	valid_0's multi_logloss: 0.907657	valid_0's weighted-f1-score: 0.658393
[600]	valid_0's multi_logloss: 0.907547	valid_0's weighted-f1-score: 0.658489
[650]	valid_0's multi_logloss: 0.907497	valid_0's weighted-f1-score: 0.658723
[700]	valid_0's multi_logloss: 0.907411	valid_0's weighted-f1-score: 0.658786
[750]	valid_0's multi_logloss: 0.907376	valid_0's weighted-f1-score: 0.658851
[800]	valid_0's multi_logloss: 0.90748	valid_0's weighted-f1-score: 0.659033
[850]	valid_0's multi_logloss: 0.907536	valid_0's weighted-f1-score: 0.658874
[900]	valid_0's multi_logloss: 0.90763	valid_0's weighted-f1-score: 0.658962
[950]	valid_0's multi_logloss: 0.907734	valid_0's weighted-f1-score: 0.659107
[1000]	valid_0's multi_logloss: 0.907932	valid_0's weighted-f1-score: 0.659013
[1050]	valid_0's multi_logloss: 0.907989	valid_0's weighted-f1-score: 0.659308
[1100]	valid_0's multi_logloss: 0.908158	valid_0's weighted-f1-score: 0.65942
[1150]	valid_0's multi_logloss: 0.908461	valid_0's weighted-f1-score: 0.659236
[1200]	valid_0's multi_logloss: 0.908636	valid_0's weighted-f1-score: 0.659308
[1250]	valid_0's multi_logloss: 0.908732	valid_0's weighted-f1-score: 0.659318
Early stopping, best iteration is:
[768]	valid_0's multi_logloss: 0.90737	valid_0's weighted-f1-score: 0.65907
#######################################+ o20 d20
[50]	valid_0's multi_logloss: 1.03631	valid_0's weighted-f1-score: 0.650843
[100]	valid_0's multi_logloss: 0.941285	valid_0's weighted-f1-score: 0.654565
[150]	valid_0's multi_logloss: 0.919105	valid_0's weighted-f1-score: 0.656299
[200]	valid_0's multi_logloss: 0.91251	valid_0's weighted-f1-score: 0.65682
[250]	valid_0's multi_logloss: 0.909975	valid_0's weighted-f1-score: 0.65746
[300]	valid_0's multi_logloss: 0.908987	valid_0's weighted-f1-score: 0.657887
[350]	valid_0's multi_logloss: 0.908493	valid_0's weighted-f1-score: 0.658034
[400]	valid_0's multi_logloss: 0.908171	valid_0's weighted-f1-score: 0.658017
[450]	valid_0's multi_logloss: 0.907976	valid_0's weighted-f1-score: 0.658002
[500]	valid_0's multi_logloss: 0.907813	valid_0's weighted-f1-score: 0.658387
[550]	valid_0's multi_logloss: 0.907709	valid_0's weighted-f1-score: 0.658563
[600]	valid_0's multi_logloss: 0.907606	valid_0's weighted-f1-score: 0.658438
[650]	valid_0's multi_logloss: 0.907525	valid_0's weighted-f1-score: 0.658232
[700]	valid_0's multi_logloss: 0.907471	valid_0's weighted-f1-score: 0.658343
[750]	valid_0's multi_logloss: 0.907409	valid_0's weighted-f1-score: 0.658454
[800]	valid_0's multi_logloss: 0.907517	valid_0's weighted-f1-score: 0.658626
[850]	valid_0's multi_logloss: 0.907571	valid_0's weighted-f1-score: 0.658821
[900]	valid_0's multi_logloss: 0.907701	valid_0's weighted-f1-score: 0.658535
[950]	valid_0's multi_logloss: 0.907749	valid_0's weighted-f1-score: 0.65884
[1000]	valid_0's multi_logloss: 0.907899	valid_0's weighted-f1-score: 0.658686
[1050]	valid_0's multi_logloss: 0.90799	valid_0's weighted-f1-score: 0.658514
[1100]	valid_0's multi_logloss: 0.908058	valid_0's weighted-f1-score: 0.658708
[1150]	valid_0's multi_logloss: 0.908152	valid_0's weighted-f1-score: 0.658656
[1200]	valid_0's multi_logloss: 0.908405	valid_0's weighted-f1-score: 0.658711
Early stopping, best iteration is:
[741]	valid_0's multi_logloss: 0.907398	valid_0's weighted-f1-score: 0.658395

######################################添加了两个时序特征 线上提交：0.6901
[50]	valid_0's multi_logloss: 1.02856	valid_0's weighted-f1-score: 0.654652
[100]	valid_0's multi_logloss: 0.931911	valid_0's weighted-f1-score: 0.659971
[150]	valid_0's multi_logloss: 0.909663	valid_0's weighted-f1-score: 0.662033
[200]	valid_0's multi_logloss: 0.902975	valid_0's weighted-f1-score: 0.662964
[250]	valid_0's multi_logloss: 0.900741	valid_0's weighted-f1-score: 0.66333
[300]	valid_0's multi_logloss: 0.899786	valid_0's weighted-f1-score: 0.663819
[350]	valid_0's multi_logloss: 0.899421	valid_0's weighted-f1-score: 0.663786
[400]	valid_0's multi_logloss: 0.899192	valid_0's weighted-f1-score: 0.66425
[450]	valid_0's multi_logloss: 0.898975	valid_0's weighted-f1-score: 0.663975
[500]	valid_0's multi_logloss: 0.898899	valid_0's weighted-f1-score: 0.66458
[550]	valid_0's multi_logloss: 0.898914	valid_0's weighted-f1-score: 0.664743
[600]	valid_0's multi_logloss: 0.899034	valid_0's weighted-f1-score: 0.664651
[650]	valid_0's multi_logloss: 0.899192	valid_0's weighted-f1-score: 0.664588
[700]	valid_0's multi_logloss: 0.899227	valid_0's weighted-f1-score: 0.664838
[750]	valid_0's multi_logloss: 0.899304	valid_0's weighted-f1-score: 0.664812
[800]	valid_0's multi_logloss: 0.899587	valid_0's weighted-f1-score: 0.664791
[850]	valid_0's multi_logloss: 0.899807	valid_0's weighted-f1-score: 0.664809
[900]	valid_0's multi_logloss: 0.899968	valid_0's weighted-f1-score: 0.664794

####################### 添加了 ext 全部（不包括min);包括plan sd 等  线上: 0.69025966
50]	valid_0's multi_logloss: 1.02689	valid_0's weighted-f1-score: 0.656367
[100]	valid_0's multi_logloss: 0.930064	valid_0's weighted-f1-score: 0.660671
[150]	valid_0's multi_logloss: 0.907428	valid_0's weighted-f1-score: 0.662117
[200]	valid_0's multi_logloss: 0.900657	valid_0's weighted-f1-score: 0.663156
[250]	valid_0's multi_logloss: 0.898521	valid_0's weighted-f1-score: 0.66352
[300]	valid_0's multi_logloss: 0.897548	valid_0's weighted-f1-score: 0.663945
[350]	valid_0's multi_logloss: 0.89729	valid_0's weighted-f1-score: 0.664084
[400]	valid_0's multi_logloss: 0.897089	valid_0's weighted-f1-score: 0.664163
[450]	valid_0's multi_logloss: 0.897062	valid_0's weighted-f1-score: 0.664151
[500]	valid_0's multi_logloss: 0.896956	valid_0's weighted-f1-score: 0.664221
[550]	valid_0's multi_logloss: 0.896946	valid_0's weighted-f1-score: 0.66439
[600]	valid_0's multi_logloss: 0.896996	valid_0's weighted-f1-score: 0.664383
[650]	valid_0's multi_logloss: 0.897013	valid_0's weighted-f1-score: 0.66474
[700]	valid_0's multi_logloss: 0.897103	valid_0's weighted-f1-score: 0.664642
[750]	valid_0's multi_logloss: 0.897234	valid_0's weighted-f1-score: 0.664761
[800]	valid_0's multi_logloss: 0.897499	valid_0's weighted-f1-score: 0.66478
[850]	valid_0's multi_logloss: 0.897641	valid_0's weighted-f1-score: 0.664733
[900]	valid_0's multi_logloss: 0.89774	valid_0's weighted-f1-score: 0.664793
[950]	valid_0's multi_logloss: 0.897979	valid_0's weighted-f1-score: 0.665092

############## 添加了max mode  深度 51 0.04
[50]	valid_0's multi_logloss: 1.07566	valid_0's weighted-f1-score: 0.655428
[100]	valid_0's multi_logloss: 0.949525	valid_0's weighted-f1-score: 0.66033
[150]	valid_0's multi_logloss: 0.915329	valid_0's weighted-f1-score: 0.662086
[200]	valid_0's multi_logloss: 0.903447	valid_0's weighted-f1-score: 0.663265
[250]	valid_0's multi_logloss: 0.898948	valid_0's weighted-f1-score: 0.663783
[300]	valid_0's multi_logloss: 0.897137	valid_0's weighted-f1-score: 0.664099
[350]	valid_0's multi_logloss: 0.896389	valid_0's weighted-f1-score: 0.664536

###########去掉 std  p_cls

[50]	valid_0's multi_logloss: 1.02642	valid_0's weighted-f1-score: 0.656514
[100]	valid_0's multi_logloss: 0.929603	valid_0's weighted-f1-score: 0.66111
[150]	valid_0's multi_logloss: 0.906841	valid_0's weighted-f1-score: 0.662815
[200]	valid_0's multi_logloss: 0.900295	valid_0's weighted-f1-score: 0.663837
[250]	valid_0's multi_logloss: 0.898123	valid_0's weighted-f1-score: 0.664078
[300]	valid_0's multi_logloss: 0.897251	valid_0's weighted-f1-score: 0.664098
[350]	valid_0's multi_logloss: 0.896952	valid_0's weighted-f1-score: 0.664154
[400]	valid_0's multi_logloss: 0.896802	valid_0's weighted-f1-score: 0.6644
[450]	valid_0's multi_logloss: 0.896808	valid_0's weighted-f1-score: 0.664389
[500]	valid_0's multi_logloss: 0.89684	valid_0's weighted-f1-score: 0.66446
[550]	valid_0's multi_logloss: 0.896847	valid_0's weighted-f1-score: 0.66468
[600]	valid_0's multi_logloss: 0.896984	valid_0's weighted-f1-score: 0.664496
[650]	valid_0's multi_logloss: 0.897075	valid_0's weighted-f1-score: 0.664317

##############去掉
[50]	valid_0's multi_logloss: 1.02654	valid_0's weighted-f1-score: 0.656619
[100]	valid_0's multi_logloss: 0.929708	valid_0's weighted-f1-score: 0.661139
[150]	valid_0's multi_logloss: 0.906874	valid_0's weighted-f1-score: 0.662517

#######添加 020_max_mode 提升一点点
[50]	valid_0's multi_logloss: 1.02714	valid_0's weighted-f1-score: 0.655092
[100]	valid_0's multi_logloss: 0.930474	valid_0's weighted-f1-score: 0.660458
[150]	valid_0's multi_logloss: 0.907753	valid_0's weighted-f1-score: 0.662517
[200]	valid_0's multi_logloss: 0.900927	valid_0's weighted-f1-score: 0.663304
[250]	valid_0's multi_logloss: 0.898662	valid_0's weighted-f1-score: 0.663481
[300]	valid_0's multi_logloss: 0.89783	valid_0's weighted-f1-score: 0.663787
[350]	valid_0's multi_logloss: 0.897435	valid_0's weighted-f1-score: 0.664203
[400]	valid_0's multi_logloss: 0.897353	valid_0's weighted-f1-score: 0.664261
[450]	valid_0's multi_logloss: 0.897222	valid_0's weighted-f1-score: 0.664344
[500]	valid_0's multi_logloss: 0.897091	valid_0's weighted-f1-score: 0.664565
[550]	valid_0's multi_logloss: 0.897053	valid_0's weighted-f1-score: 0.664779
[600]	valid_0's multi_logloss: 0.897252	valid_0's weighted-f1-score: 0.664623
[650]	valid_0's multi_logloss: 0.897214	valid_0's weighted-f1-score: 0.664598
[700]	valid_0's multi_logloss: 0.897382	valid_0's weighted-f1-score: 0.664421
[750]	valid_0's multi_logloss: 0.897396	valid_0's weighted-f1-score: 0.664684
[800]	valid_0's multi_logloss: 0.897571	valid_0's weighted-f1-score: 0.664498
[850]	valid_0's multi_logloss: 0.897587	valid_0's weighted-f1-score: 0.664586
[900]	valid_0's multi_logloss: 0.897729	valid_0's weighted-f1-score: 0.664722
[950]	valid_0's multi_logloss: 0.897856	valid_0's weighted-f1-score: 0.66499
[1000]	valid_0's multi_logloss: 0.897987	valid_0's weighted-f1-score: 0.664772

####################################### 只天添加 num_direct_distance 'last_mode', 'pre_mode'
[50]	valid_0's multi_logloss: 1.02844	valid_0's weighted-f1-score: 0.654613
[100]	valid_0's multi_logloss: 0.931685	valid_0's weighted-f1-score: 0.660217
[150]	valid_0's multi_logloss: 0.909181	valid_0's weighted-f1-score: 0.662308
[200]	valid_0's multi_logloss: 0.902522	valid_0's weighted-f1-score: 0.662833
[250]	valid_0's multi_logloss: 0.900229	valid_0's weighted-f1-score: 0.663032
[300]	valid_0's multi_logloss: 0.89932	valid_0's weighted-f1-score: 0.663585
[350]	valid_0's multi_logloss: 0.898876	valid_0's weighted-f1-score: 0.663793
[400]	valid_0's multi_logloss: 0.898727	valid_0's weighted-f1-score: 0.663859
[450]	valid_0's multi_logloss: 0.898584	valid_0's weighted-f1-score: 0.663917
[500]	valid_0's multi_logloss: 0.898519	valid_0's weighted-f1-score: 0.663745
[550]	valid_0's multi_logloss: 0.898555	valid_0's weighted-f1-score: 0.663994
[600]	valid_0's multi_logloss: 0.898651	valid_0's weighted-f1-score: 0.66381
[650]	valid_0's multi_logloss: 0.898603	valid_0's weighted-f1-score: 0.663828
[700]	valid_0's multi_logloss: 0.898697	valid_0's weighted-f1-score: 0.66391
[750]	valid_0's multi_logloss: 0.898833	valid_0's weighted-f1-score: 0.66394
[800]	valid_0's multi_logloss: 0.89899	valid_0's weighted-f1-score: 0.664164
[850]	valid_0's multi_logloss: 0.899113	valid_0's weighted-f1-score: 0.664119
[900]	valid_0's multi_logloss: 0.899267	valid_0's weighted-f1-score: 0.664489
[950]	valid_0's multi_logloss: 0.899399	valid_0's weighted-f1-score: 0.664602
Early stopping, best iteration is:
[481]	valid_0's multi_logloss: 0.898507	valid_0's weighted-f1-score: 0.663841

############################# 40层

Training until validation scores don't improve for 500 rounds.
[50]	valid_0's multi_logloss: 1.02563	valid_0's weighted-f1-score: 0.655458
[100]	valid_0's multi_logloss: 0.929025	valid_0's weighted-f1-score: 0.661145
[150]	valid_0's multi_logloss: 0.906503	valid_0's weighted-f1-score: 0.662968
[200]	valid_0's multi_logloss: 0.899926	valid_0's weighted-f1-score: 0.663767
[250]	valid_0's multi_logloss: 0.897757	valid_0's weighted-f1-score: 0.663913
[300]	valid_0's multi_logloss: 0.896945	valid_0's weighted-f1-score: 0.664237
[350]	valid_0's multi_logloss: 0.896575	valid_0's weighted-f1-score: 0.664437
[400]	valid_0's multi_logloss: 0.896453	valid_0's weighted-f1-score: 0.664409
[450]	valid_0's multi_logloss: 0.896351	valid_0's weighted-f1-score: 0.664798
[500]	valid_0's multi_logloss: 0.896355	valid_0's weighted-f1-score: 0.664739
[550]	valid_0's multi_logloss: 0.896447	valid_0's weighted-f1-score: 0.664833
[600]	valid_0's multi_logloss: 0.89653	valid_0's weighted-f1-score: 0.66492
[650]	valid_0's multi_logloss: 0.896553	valid_0's weighted-f1-score: 0.665033
[700]	valid_0's multi_logloss: 0.89668	valid_0's weighted-f1-score: 0.665031
[750]	valid_0's multi_logloss: 0.896885	valid_0's weighted-f1-score: 0.664963
[800]	valid_0's multi_logloss: 0.897007	valid_0's weighted-f1-score: 0.664787
[850]	valid_0's multi_logloss: 0.897207	valid_0's weighted-f1-score: 0.664965
[900]	valid_0's multi_logloss: 0.897516	valid_0's weighted-f1-score: 0.66515
[950]	valid_0's multi_logloss: 0.897772	valid_0's weighted-f1-score: 0.665038
Early stopping, best iteration is:
[484]	valid_0's multi_logloss: 0.896303	valid_0's weighted-f1-score: 0.664952
#######################################1
Training until validation scores don't improve for 500 rounds.
[50]	valid_0's multi_logloss: 1.02299	valid_0's weighted-f1-score: 0.656425
[100]	valid_0's multi_logloss: 0.926353	valid_0's weighted-f1-score: 0.661469
[150]	valid_0's multi_logloss: 0.903735	valid_0's weighted-f1-score: 0.662975
[200]	valid_0's multi_logloss: 0.897068	valid_0's weighted-f1-score: 0.664148
[250]	valid_0's multi_logloss: 0.894789	valid_0's weighted-f1-score: 0.664384
[300]	valid_0's multi_logloss: 0.893849	valid_0's weighted-f1-score: 0.664742
[350]	valid_0's multi_logloss: 0.893533	valid_0's weighted-f1-score: 0.665044
[400]	valid_0's multi_logloss: 0.893508	valid_0's weighted-f1-score: 0.665022
[450]	valid_0's multi_logloss: 0.893418	valid_0's weighted-f1-score: 0.665213
[500]	valid_0's multi_logloss: 0.893411	valid_0's weighted-f1-score: 0.665329
[550]	valid_0's multi_logloss: 0.893461	valid_0's weighted-f1-score: 0.665484
[600]	valid_0's multi_logloss: 0.893592	valid_0's weighted-f1-score: 0.665553
[650]	valid_0's multi_logloss: 0.893777	valid_0's weighted-f1-score: 0.665487
[700]	valid_0's multi_logloss: 0.894029	valid_0's weighted-f1-score: 0.665503
[750]	valid_0's multi_logloss: 0.894191	valid_0's weighted-f1-score: 0.665629
[800]	valid_0's multi_logloss: 0.894378	valid_0's weighted-f1-score: 0.665432
[850]	valid_0's multi_logloss: 0.894627	valid_0's weighted-f1-score: 0.665588
[900]	valid_0's multi_logloss: 0.894951	valid_0's weighted-f1-score: 0.665465
Early stopping, best iteration is:
[441]	valid_0's multi_logloss: 0.893397	valid_0's weighted-f1-score: 0.665058
#######################################2
Training until validation scores don't improve for 500 rounds.
[50]	valid_0's multi_logloss: 1.02183	valid_0's weighted-f1-score: 0.656544
[100]	valid_0's multi_logloss: 0.924769	valid_0's weighted-f1-score: 0.661273
[150]	valid_0's multi_logloss: 0.901973	valid_0's weighted-f1-score: 0.663522
[200]	valid_0's multi_logloss: 0.895046	valid_0's weighted-f1-score: 0.664369
[250]	valid_0's multi_logloss: 0.892815	valid_0's weighted-f1-score: 0.664849
[300]	valid_0's multi_logloss: 0.89209	valid_0's weighted-f1-score: 0.665208
[350]	valid_0's multi_logloss: 0.891786	valid_0's weighted-f1-score: 0.665228
[400]	valid_0's multi_logloss: 0.891553	valid_0's weighted-f1-score: 0.665513
[450]	valid_0's multi_logloss: 0.891585	valid_0's weighted-f1-score: 0.665739
[500]	valid_0's multi_logloss: 0.8915	valid_0's weighted-f1-score: 0.66601
[550]	valid_0's multi_logloss: 0.891633	valid_0's weighted-f1-score: 0.666071
[600]	valid_0's multi_logloss: 0.89174	valid_0's weighted-f1-score: 0.665969
[650]	valid_0's multi_logloss: 0.891905	valid_0's weighted-f1-score: 0.666029
[700]	valid_0's multi_logloss: 0.891861	valid_0's weighted-f1-score: 0.665834

############################# 40层 L2 =1  0.69109503
'learning_rate': 0.01,
'num_leaves': 40,
'lambda_l1': 0.01,
'lambda_l2': 1,
Training until validation scores don't improve for 500 rounds.
[50]	valid_0's multi_logloss: 1.53924	valid_0's weighted-f1-score: 0.574451
[100]	valid_0's multi_logloss: 1.29519	valid_0's weighted-f1-score: 0.640267
[150]	valid_0's multi_logloss: 1.15935	valid_0's weighted-f1-score: 0.650707
[200]	valid_0's multi_logloss: 1.07767	valid_0's weighted-f1-score: 0.653929
[250]	valid_0's multi_logloss: 1.02579	valid_0's weighted-f1-score: 0.655925
[300]	valid_0's multi_logloss: 0.991289	valid_0's weighted-f1-score: 0.657412
[350]	valid_0's multi_logloss: 0.967421	valid_0's weighted-f1-score: 0.658933
[400]	valid_0's multi_logloss: 0.950345	valid_0's weighted-f1-score: 0.659832
[450]	valid_0's multi_logloss: 0.937794	valid_0's weighted-f1-score: 0.660233
[500]	valid_0's multi_logloss: 0.928373	valid_0's weighted-f1-score: 0.660759
[550]	valid_0's multi_logloss: 0.92128	valid_0's weighted-f1-score: 0.661464
[600]	valid_0's multi_logloss: 0.915876	valid_0's weighted-f1-score: 0.661814
[650]	valid_0's multi_logloss: 0.911651	valid_0's weighted-f1-score: 0.662154
[700]	valid_0's multi_logloss: 0.908377	valid_0's weighted-f1-score: 0.662714
[750]	valid_0's multi_logloss: 0.905825	valid_0's weighted-f1-score: 0.663127
[800]	valid_0's multi_logloss: 0.9038	valid_0's weighted-f1-score: 0.663098
[850]	valid_0's multi_logloss: 0.902197	valid_0's weighted-f1-score: 0.663326
[900]	valid_0's multi_logloss: 0.900904	valid_0's weighted-f1-score: 0.663367
[950]	valid_0's multi_logloss: 0.899913	valid_0's weighted-f1-score: 0.663485
[1000]	valid_0's multi_logloss: 0.899084	valid_0's weighted-f1-score: 0.663562
[1050]	valid_0's multi_logloss: 0.898407	valid_0's weighted-f1-score: 0.663725
[1100]	valid_0's multi_logloss: 0.897851	valid_0's weighted-f1-score: 0.663882
[1150]	valid_0's multi_logloss: 0.897419	valid_0's weighted-f1-score: 0.663926
[1200]	valid_0's multi_logloss: 0.897056	valid_0's weighted-f1-score: 0.663833
[1250]	valid_0's multi_logloss: 0.896728	valid_0's weighted-f1-score: 0.663805
[1300]	valid_0's multi_logloss: 0.896491	valid_0's weighted-f1-score: 0.663776
[1350]	valid_0's multi_logloss: 0.896275	valid_0's weighted-f1-score: 0.663875
[1400]	valid_0's multi_logloss: 0.896098	valid_0's weighted-f1-score: 0.663947
[1450]	valid_0's multi_logloss: 0.895923	valid_0's weighted-f1-score: 0.663898
[1500]	valid_0's multi_logloss: 0.895787	valid_0's weighted-f1-score: 0.664044
[1550]	valid_0's multi_logloss: 0.89568	valid_0's weighted-f1-score: 0.664042
[1837]	valid_0's multi_logloss: 0.893908	valid_0's weighted-f1-score: 0.664175
cv f1-score:  0.6654375284993601


########## features_all_ts_p10_s20_zero 换为 L2 1-->0.1
[50]	valid_0's multi_logloss: 1.539	valid_0's weighted-f1-score: 0.573561
[100]	valid_0's multi_logloss: 1.29497	valid_0's weighted-f1-score: 0.641072
[150]	valid_0's multi_logloss: 1.15945	valid_0's weighted-f1-score: 0.650799
[200]	valid_0's multi_logloss: 1.07786	valid_0's weighted-f1-score: 0.65374
[250]	valid_0's multi_logloss: 1.02606	valid_0's weighted-f1-score: 0.655805
[300]	valid_0's multi_logloss: 0.991608	valid_0's weighted-f1-score: 0.657414
[350]	valid_0's multi_logloss: 0.967753	valid_0's weighted-f1-score: 0.658561
[400]	valid_0's multi_logloss: 0.950713	valid_0's weighted-f1-score: 0.659392

##############
'learning_rate': 0.01,
'num_leaves': 40,
'lambda_l1': 0.01,
'lambda_l2': 0.1,

pid_ext_features = [
    # 'pid',
    'last_mode', 'pre_mode',
    'pid_max_mode',
    'pid_max_dist', 'pid_mean_dist',
    'pid_max_price', 'pid_mean_price',
    'pid_max_eta', 'pid_min_eta', 'pid_mean_eta',
    'pid_max_dj', 'pid_mean_dj',
    'pid_max_sd', 'pid_min_sd',
    'pid_std_sd', 'pid_std_dist', 'pid_std_price', 'pid_std_eta', 'pid_std_dj', 'pid_mean_sd',
    # # 各个模式占比
    'mode_num_0', 'mode_num_1', 'mode_num_2', 'mode_num_3', 'mode_num_4',
    'mode_num_5', 'mode_num_6', 'mode_num_7', 'mode_num_8', 'mode_num_9',
    'mode_num_10', 'mode_num_11'
]

plans_features = [
    'mode_feas_0', 'mode_feas_1', 'mode_feas_2', 'mode_feas_3',
    'mode_feas_4', 'mode_feas_5', 'mode_feas_6', 'mode_feas_7',
    'mode_feas_8', 'mode_feas_9', 'mode_feas_10', 'mode_feas_11',
    'first_mode', 'second_mode', 'last_mode_1',
    'max_dist', 'min_dist', 'mean_dist', 'std_dist',
    'max_price', 'min_price', 'mean_price', 'std_price',
    'max_eta', 'min_eta', 'mean_eta', 'std_eta',
    'max_dj', 'min_dj', 'mean_dj', 'std_dj',
    'max_sd', 'min_sd', 'mean_sd', 'std_sd',
    'max_sd_dj', 'min_sd_dj', 'mean_sd_dj', 'std_sd_dj',
    'max_price_eta', 'min_price_eta', 'mean_price_eta', 'std_price_eta',
    'max_dist_mode', 'min_dist_mode',
    'max_price_mode', 'min_price_mode',
    'max_eta_mode', 'min_eta_mode',
    'max_sd_mode', 'min_sd_mode',
    'max_dj_mode', 'min_dj_mode',
    'max_sd_dj_mode', 'min_sd_dj_mode',
    'max_price_eta_mode', 'min_price_eta_mode',
    'svd_mode_0', 'svd_mode_1', 'svd_mode_2', 'svd_mode_3',
    'svd_mode_4', 'svd_mode_5', 'svd_mode_6', 'svd_mode_7', 'svd_mode_8',
    'svd_mode_9'

]

feature_columns = od_features + time_features + profile_svd_features + pid_ext_features + plans_features

cate_columns = ['max_dist_mode', 'min_dist_mode',
                'max_price_mode', 'min_price_mode',
                'max_eta_mode', 'min_eta_mode',
                'max_sd_mode', 'min_sd_mode',
                'max_dj_mode', 'min_dj_mode',
                'max_sd_dj_mode', 'min_sd_dj_mode',
                'max_price_eta_mode', 'min_price_eta_mode',

                'last_mode', 'pre_mode',
                'first_mode', 'second_mode', 'last_mode_1',
                'weekday', 'hour','is_week_end',
                'o20', 'd20',  'o20_max_mode', 'd20_max_mode','same_cls20'
train_df.loc[train_df['click_mode'].isin([3,4, 6]), 'weight'] = 3

# weight [3,4,6] 2.2
[50]	valid_0's multi_logloss: 1.57456	valid_0's weighted-f1-score: 0.57546
[100]	valid_0's multi_logloss: 1.32972	valid_0's weighted-f1-score: 0.6538
[150]	valid_0's multi_logloss: 1.19218	valid_0's weighted-f1-score: 0.662809
[200]	valid_0's multi_logloss: 1.10848	valid_0's weighted-f1-score: 0.664898
[250]	valid_0's multi_logloss: 1.05497	valid_0's weighted-f1-score: 0.666516
[300]	valid_0's multi_logloss: 1.01931	valid_0's weighted-f1-score: 0.667177
[350]	valid_0's multi_logloss: 0.994829	valid_0's weighted-f1-score: 0.66808
[400]	valid_0's multi_logloss: 0.977481	valid_0's weighted-f1-score: 0.668188


###################
train_df.loc[train_df['click_mode'].isin([0,3,4, 6,9,11]), 'weight'] = 2
[50]	valid_0's multi_logloss: 1.58986	valid_0's weighted-f1-score: 0.595999
[100]	valid_0's multi_logloss: 1.34176	valid_0's weighted-f1-score: 0.655261
[150]	valid_0's multi_logloss: 1.20217	valid_0's weighted-f1-score: 0.658901
[200]	valid_0's multi_logloss: 1.11712	valid_0's weighted-f1-score: 0.662222
[250]	valid_0's multi_logloss: 1.06275	valid_0's weighted-f1-score: 0.664308
[300]	valid_0's multi_logloss: 1.02658	valid_0's weighted-f1-score: 0.665567
[350]	valid_0's multi_logloss: 1.00176	valid_0's weighted-f1-score: 0.666767
[400]	valid_0's multi_logloss: 0.984164	valid_0's weighted-f1-score: 0.667229
[450]	valid_0's multi_logloss: 0.971555	valid_0's weighted-f1-score: 0.667421

######################train_df.loc[train_df['click_mode'].isin([0,3,4, 6,9,11]), 'weight'] = 1.5
[50]	valid_0's multi_logloss: 1.55812	valid_0's weighted-f1-score: 0.585794
[100]	valid_0's multi_logloss: 1.31226	valid_0's weighted-f1-score: 0.650136
[150]	valid_0's multi_logloss: 1.17459	valid_0's weighted-f1-score: 0.658765
[200]	valid_0's multi_logloss: 1.09115	valid_0's weighted-f1-score: 0.661053
[250]	valid_0's multi_logloss: 1.038	valid_0's weighted-f1-score: 0.6622
[300]	valid_0's multi_logloss: 1.00266	valid_0's weighted-f1-score: 0.663248
[350]	valid_0's multi_logloss: 0.978375	valid_0's weighted-f1-score: 0.664219
[400]	valid_0's multi_logloss: 0.961167	valid_0's weighted-f1-score: 0.665045
[450]	valid_0's multi_logloss: 0.948667	valid_0's weighted-f1-score: 0.665386
[500]	valid_0's multi_logloss: 0.939401	valid_0's weighted-f1-score: 0.665924
[550]	valid_0's multi_logloss: 0.932502	valid_0's weighted-f1-score: 0.666353
[600]	valid_0's multi_logloss: 0.927274	valid_0's weighted-f1-score: 0.666769
[650]	valid_0's multi_logloss: 0.923243	valid_0's weighted-f1-score: 0.667332
[700]	valid_0's multi_logloss: 0.920125	valid_0's weighted-f1-score: 0.667431

################ 0.69555022
train_df.loc[train_df['click_mode'].isin([3,4, 6]), 'weight'] = 2
'learning_rate': 0.01,
        'num_leaves': 45,
        'lambda_l1': 0.01,
        'lambda_l2': 0.1,
        'num_class': 12,

[50]	valid_0's multi_logloss: 1.56567	valid_0's weighted-f1-score: 0.573369
[100]	valid_0's multi_logloss: 1.32091	valid_0's weighted-f1-score: 0.652344
[150]	valid_0's multi_logloss: 1.18368	valid_0's weighted-f1-score: 0.66175
[200]	valid_0's multi_logloss: 1.10032	valid_0's weighted-f1-score: 0.664197
[250]	valid_0's multi_logloss: 1.04714	valid_0's weighted-f1-score: 0.66572
[300]	valid_0's multi_logloss: 1.01174	valid_0's weighted-f1-score: 0.666611
[350]	valid_0's multi_logloss: 0.987384	valid_0's weighted-f1-score: 0.667556
[400]	valid_0's multi_logloss: 0.970121	valid_0's weighted-f1-score: 0.667897
[450]	valid_0's multi_logloss: 0.957599	valid_0's weighted-f1-score: 0.668213
[500]	valid_0's multi_logloss: 0.948312	valid_0's weighted-f1-score: 0.668594
[550]	valid_0's multi_logloss: 0.941382	valid_0's weighted-f1-score: 0.66888
[600]	valid_0's multi_logloss: 0.936133	valid_0's weighted-f1-score: 0.669252
[650]	valid_0's multi_logloss: 0.932115	valid_0's weighted-f1-score: 0.669643
[700]	valid_0's multi_logloss: 0.928984	valid_0's weighted-f1-score: 0.669793
############### 55层
train_df.loc[train_df['click_mode'].isin([3, 6]), 'weight'] = 2
train_df.loc[train_df['click_mode'].isin([0, 4,9]), 'weight'] = 3

效果不好 三行好一点

##########################
train_df.loc[train_df['click_mode'].isin([4, 6,11]), 'weight'] = 2
train_df.loc[train_df['click_mode'].isin([3]), 'weight'] = 1.8
[50]	valid_0's multi_logloss: 1.5639	valid_0's weighted-f1-score: 0.579793
[100]	valid_0's multi_logloss: 1.3181	valid_0's weighted-f1-score: 0.651502
[150]	valid_0's multi_logloss: 1.18054	valid_0's weighted-f1-score: 0.660203
[200]	valid_0's multi_logloss: 1.09712	valid_0's weighted-f1-score: 0.662781
[250]	valid_0's multi_logloss: 1.04394	valid_0's weighted-f1-score: 0.664443
[300]	valid_0's multi_logloss: 1.00861	valid_0's weighted-f1-score: 0.665469
[350]	valid_0's multi_logloss: 0.98429	valid_0's weighted-f1-score: 0.666255
[400]	valid_0's multi_logloss: 0.967017	valid_0's weighted-f1-score: 0.667005
[450]	valid_0's multi_logloss: 0.954494	valid_0's weighted-f1-score: 0.667282
[500]	valid_0's multi_logloss: 0.945155	valid_0's weighted-f1-score: 0.667876
[550]	valid_0's multi_logloss: 0.93819	valid_0's weighted-f1-score: 0.667893
[600]	valid_0's multi_logloss: 0.932908	valid_0's weighted-f1-score: 0.66837
[650]	valid_0's multi_logloss: 0.928823	valid_0's weighted-f1-score: 0.668858
#########################################
train_df.loc[train_df['click_mode'].isin([4, 6,11]), 'weight'] = 2.2
train_df.loc[train_df['click_mode'].isin([3]), 'weight'] = 2

[50]	valid_0's multi_logloss: 1.57241	valid_0's weighted-f1-score: 0.58373
[100]	valid_0's multi_logloss: 1.32633	valid_0's weighted-f1-score: 0.653576
[150]	valid_0's multi_logloss: 1.18837	valid_0's weighted-f1-score: 0.662014
[200]	valid_0's multi_logloss: 1.10456	valid_0's weighted-f1-score: 0.664572
[250]	valid_0's multi_logloss: 1.05106	valid_0's weighted-f1-score: 0.666074
[300]	valid_0's multi_logloss: 1.01548	valid_0's weighted-f1-score: 0.666848
[350]	valid_0's multi_logloss: 0.991022	valid_0's weighted-f1-score: 0.667521
[400]	valid_0's multi_logloss: 0.973629	valid_0's weighted-f1-score: 0.667943
[450]	valid_0's multi_logloss: 0.961089	valid_0's weighted-f1-score: 0.668253
[500]	valid_0's multi_logloss: 0.951725	valid_0's weighted-f1-score: 0.66865
[550]	valid_0's multi_logloss: 0.944704	valid_0's weighted-f1-score: 0.668856
[600]	valid_0's multi_logloss: 0.939411	valid_0's weighted-f1-score: 0.668886
[650]	valid_0's multi_logloss: 0.935323	valid_0's weighted-f1-score: 0.669377
[700]	valid_0's multi_logloss: 0.932149	valid_0's weighted-f1-score: 0.669439
[750]	valid_0's multi_logloss: 0.929657	valid_0's weighted-f1-score: 0.66965
[800]	valid_0's multi_logloss: 0.927708	valid_0's weighted-f1-score: 0.669849
[850]	valid_0's multi_logloss: 0.92612	valid_0's weighted-f1-score: 0.669858
[900]	valid_0's multi_logloss: 0.924826	valid_0's weighted-f1-score: 0.669915
[950]	valid_0's multi_logloss: 0.9238	valid_0's weighted-f1-score: 0.669943
[1000]	valid_0's multi_logloss: 0.922997	valid_0's weighted-f1-score: 0.670022
[1050]	valid_0's multi_logloss: 0.922305	valid_0's weighted-f1-score: 0.670074
[1100]	valid_0's multi_logloss: 0.921715	valid_0's weighted-f1-score: 0.670123
[1150]	valid_0's multi_logloss: 0.921212	valid_0's weighted-f1-score: 0.670147
[1200]	valid_0's multi_logloss: 0.920748	valid_0's weighted-f1-score: 0.670102
[1250]	valid_0's multi_logloss: 0.920339	valid_0's weighted-f1-score: 0.670208
[1300]	valid_0's multi_logloss: 0.920011	valid_0's weighted-f1-score: 0.67025
[1350]	valid_0's multi_logloss: 0.919695	valid_0's weighted-f1-score: 0.670329
[1400]	valid_0's multi_logloss: 0.919396	valid_0's weighted-f1-score: 0.670348
[1450]	valid_0's multi_logloss: 0.91914	valid_0's weighted-f1-score: 0.670333
[1500]	valid_0's multi_logloss: 0.918915	valid_0's weighted-f1-score: 0.670332
[1550]	valid_0's multi_logloss: 0.918677	valid_0's weighted-f1-score: 0.670349
[1600]	valid_0's multi_logloss: 0.918477	valid_0's weighted-f1-score: 0.670322
[1650]	valid_0's multi_logloss: 0.918288	valid_0's weighted-f1-score: 0.670314
[1700]	valid_0's multi_logloss: 0.91809	valid_0's weighted-f1-score: 0.670431
[1750]	valid_0's multi_logloss: 0.917971	valid_0's weighted-f1-score: 0.670462
[1800]	valid_0's multi_logloss: 0.917835	valid_0's weighted-f1-score: 0.670504
[1850]	valid_0's multi_logloss: 0.917654	valid_0's weighted-f1-score: 0.670569
[1900]	valid_0's multi_logloss: 0.917503	valid_0's weighted-f1-score: 0.670653
[1950]	valid_0's multi_logloss: 0.917375	valid_0's weighted-f1-score: 0.670639
[2000]	valid_0's multi_logloss: 0.917238	valid_0's weighted-f1-score: 0.670615
[2050]	valid_0's multi_logloss: 0.917103	valid_0's weighted-f1-score: 0.670635
[2100]	valid_0's multi_logloss: 0.917012	valid_0's weighted-f1-score: 0.670607
[2150]	valid_0's multi_logloss: 0.916867	valid_0's weighted-f1-score: 0.670495
[2200]	valid_0's multi_logloss: 0.91672	valid_0's weighted-f1-score: 0.670382
[2250]	valid_0's multi_logloss: 0.916588	valid_0's weighted-f1-score: 0.670498
[2300]	valid_0's multi_logloss: 0.916468	valid_0's weighted-f1-score: 0.670571
[2350]	valid_0's multi_logloss: 0.916327	valid_0's weighted-f1-score: 0.67066
[2400]	valid_0's multi_logloss: 0.916237	valid_0's weighted-f1-score: 0.670669
Early stopping, best iteration is:
[1912]	valid_0's multi_logloss: 0.917482	valid_0's weighted-f1-score: 0.67071

##########################################
'num_leaves': 55,
'lambda_l1': 0.01,
'lambda_l2': 0.01,
'num_class': 12,

[50]	valid_0's multi_logloss: 1.57237	valid_0's weighted-f1-score: 0.584069
[100]	valid_0's multi_logloss: 1.32632	valid_0's weighted-f1-score: 0.653686
[150]	valid_0's multi_logloss: 1.18839	valid_0's weighted-f1-score: 0.661999
[200]	valid_0's multi_logloss: 1.10458	valid_0's weighted-f1-score: 0.664401

#########################
'learning_rate': 0.01,
'num_leaves': 61,
'lambda_l1': 0,
'lambda_l2': 0.01,

Training until validation scores don't improve for 500 rounds.
[50]	valid_0's multi_logloss: 1.57192	valid_0's weighted-f1-score: 0.584054
[100]	valid_0's multi_logloss: 1.32574	valid_0's weighted-f1-score: 0.6537
[150]	valid_0's multi_logloss: 1.18778	valid_0's weighted-f1-score: 0.662155
[200]	valid_0's multi_logloss: 1.10396	valid_0's weighted-f1-score: 0.664539
[250]	valid_0's multi_logloss: 1.05052	valid_0's weighted-f1-score: 0.666151
[300]	valid_0's multi_logloss: 1.01497	valid_0's weighted-f1-score: 0.666935
[350]	valid_0's multi_logloss: 0.990532	valid_0's weighted-f1-score: 0.667431
[400]	valid_0's multi_logloss: 0.973186	valid_0's weighted-f1-score: 0.667975
[450]	valid_0's multi_logloss: 0.960625	valid_0's weighted-f1-score: 0.668244
[500]	valid_0's multi_logloss: 0.951277	valid_0's weighted-f1-score: 0.668673
[550]	valid_0's multi_logloss: 0.944248	valid_0's weighted-f1-score: 0.668959
[600]	valid_0's multi_logloss: 0.938935	valid_0's weighted-f1-score: 0.66912
[650]	valid_0's multi_logloss: 0.934821	valid_0's weighted-f1-score: 0.66936
[700]	valid_0's multi_logloss: 0.931651	valid_0's weighted-f1-score: 0.669479
[750]	valid_0's multi_logloss: 0.92916	valid_0's weighted-f1-score: 0.669679
[800]	valid_0's multi_logloss: 0.927229	valid_0's weighted-f1-score: 0.669762
[850]	valid_0's multi_logloss: 0.925645	valid_0's weighted-f1-score: 0.669932
[900]	valid_0's multi_logloss: 0.92433	valid_0's weighted-f1-score: 0.669903
[950]	valid_0's multi_logloss: 0.923288	valid_0's weighted-f1-score: 0.669926
[1000]	valid_0's multi_logloss: 0.922469	valid_0's weighted-f1-score: 0.670098
[1050]	valid_0's multi_logloss: 0.921781	valid_0's weighted-f1-score: 0.670051
[1100]	valid_0's multi_logloss: 0.921202	valid_0's weighted-f1-score: 0.670121
[1150]	valid_0's multi_logloss: 0.920696	valid_0's weighted-f1-score: 0.670084
[1200]	valid_0's multi_logloss: 0.920206	valid_0's weighted-f1-score: 0.670195
[1250]	valid_0's multi_logloss: 0.919783	valid_0's weighted-f1-score: 0.670078
[1300]	valid_0's multi_logloss: 0.919448	valid_0's weighted-f1-score: 0.670153
[1350]	valid_0's multi_logloss: 0.919097	valid_0's weighted-f1-score: 0.670349
[1400]	valid_0's multi_logloss: 0.918785	valid_0's weighted-f1-score: 0.670412
[1450]	valid_0's multi_logloss: 0.918534	valid_0's weighted-f1-score: 0.670399
[1500]	valid_0's multi_logloss: 0.918322	valid_0's weighted-f1-score: 0.670513
[1550]	valid_0's multi_logloss: 0.918077	valid_0's weighted-f1-score: 0.670508
[1600]	valid_0's multi_logloss: 0.917847	valid_0's weighted-f1-score: 0.670552
[1650]	valid_0's multi_logloss: 0.917625	valid_0's weighted-f1-score: 0.670655
[1700]	valid_0's multi_logloss: 0.917399	valid_0's weighted-f1-score: 0.670626
[1750]	valid_0's multi_logloss: 0.917244	valid_0's weighted-f1-score: 0.67071
[1800]	valid_0's multi_logloss: 0.917073	valid_0's weighted-f1-score: 0.67082
[1850]	valid_0's multi_logloss: 0.91689	valid_0's weighted-f1-score: 0.670825
[1900]	valid_0's multi_logloss: 0.916749	valid_0's weighted-f1-score: 0.670657
[1950]	valid_0's multi_logloss: 0.916609	valid_0's weighted-f1-score: 0.670594
[2000]	valid_0's multi_logloss: 0.916476	valid_0's weighted-f1-score: 0.67051
[2050]	valid_0's multi_logloss: 0.916341	valid_0's weighted-f1-score: 0.670508
[2100]	valid_0's multi_logloss: 0.916227	valid_0's weighted-f1-score: 0.670733
[2150]	valid_0's multi_logloss: 0.916078	valid_0's weighted-f1-score: 0.670691
[2200]	valid_0's multi_logloss: 0.915926	valid_0's weighted-f1-score: 0.670703
[2250]	valid_0's multi_logloss: 0.915804	valid_0's weighted-f1-score: 0.670569
Early stopping, best iteration is:
[1795]	valid_0's multi_logloss: 0.917086	valid_0's weighted-f1-score: 0.670864